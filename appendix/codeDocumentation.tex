\chapter{Code Documentation}

The code documentation lists the JavaScript objects in bold, followed by a list of their methods.

\clearpage 

\section{Models - Backbone Models}

\subsection*{Building}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	shouldBeRemoved & Returns true if the durability of this building is <= 0. \\ \hline
	updateRevenue & Makes this building generate revenue. \\ \hline
	lowerDurability & Lower the durability of this building. \\ \hline
	render & Draw this object to a canvas context. \\ \hline
	update & Update the state of this building. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Default values for this object \\ \hline
	timeSinceRevenue & Duration since last time the building generated revenue. \\ \hline

	\end{tabular}
	\end{table}

\subsection*{Entity}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Initialize a PowerLineList for this entity. \\ \hline
	update & Update the state of this entity. Should be overwritten by subclasses. \\ \hline
	getCenterPos & Returns the center position of this entity. \\ \hline
	shouldBeRemoved & Returns if this entity should be removed from the map or not. Should be overwritten by subclasses. \\ \hline
	connectTo & Connect this entity to a PowerLine. \\ \hline
	disconnect & Disconnect this entity from a PowerLine. \\ \hline
	contains & Check if a point is inside of this entity. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Highscore}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	updateTime & Updates this high score object if the new score is smaller than the old score. \\ \hline
	saveData & Write data to local storage. \\ \hline
	toString & Returns a string representation of this object. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{Level}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Initialize and shuffle the list of possible building positions for this level. \\ \hline
	update & Update the state of the level. \\ \hline
	createBuilding & Create a new building and place it on the map. \\ \hline
	tapMap & Process user input. \\ \hline
	buildPowerPlantAt & Build a new Powerplant on the map. \\ \hline
	costOfPowerLine & Calculate the cost of a Powerline. \\ \hline
	costOfFixingPowerLine & Calculate the cost of repairing a Powerline. \\ \hline
	connectWithPowerLine & Connect two buildings with a Powerline. \\ \hline
	fixPowerLine & Repair a Powerline. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Default values for this object. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{Map}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Default values for map. \\ \hline
	\end{tabular}
	\end{table}

	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	update & Update the state of the game map. \\ \hline
	translateView & Move the view of the map. \\ \hline
	getBuildingAt & Returns the building located here on the map. Input coordinates in screen space. \\ \hline
	getBuildingAtMap & Returns the building located here on the map. Input coordinates in world space. \\ \hline
	screenToMapCoordinates & Translate coordinates from screen space to map space. \\ \hline
	getPowerLineAt & Return the powerline located here on the map. Input coordinates in screen space. \\ \hline
	\end{tabular}
	\end{table}
	

\subsection*{Player}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Player default values. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	damage & Inflict damage to the players health. \\ \hline
	\end{tabular}
	\end{table}
	

\subsection*{Powerline}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	isHealthy & Returns if this Powerline is healthy or not. \\ \hline
	getPointA & Returns the center position of the first building this Powerline is connected to. \\ \hline
	getPointB & Returns the center position of the second building this Powerline is connected to. \\ \hline
	removeFrom & Remove this Powerline from the map and disconnect everything connected to it. \\ \hline
	break & Set the state of this Powerline to broken. \\ \hline
	fix & Set the state of this Powerline to healthy. \\ \hline
	render & Draw this Powerline to the canvas context. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Powerline default values. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Powerplant}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Default values for this Powerplant. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	canBeUpgraded & Returns true if this Powerplant can be upgraded. \\ \hline
	getMaxPower & Returns how much power this powerplant can output. \\ \hline
	upgrade & Upgrade this Powerplant. \\ \hline
	distributePower & Distribute power from this Powerplant to as many connected buildings as allowed by getMaxPower using Breadth First Search. \\ \hline
	render & Draw this Powerplant to the canvas context. \\ \hline
	\end{tabular}
	\end{table}
	
\clearpage

\section{Presenters - Backbone Views}

\subsection*{HighscoreView}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Render the highscore list and begin listening to changes to the list. \\ \hline
	render & Update the HTML Object with the state of the highscore list. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{HpBar}
	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the player's health and begin listening to changes to player health. \\ \hline
	render & Draw the player's health to the HP bar canvas. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{HudMoney}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the player's money and begin listening to changes to the player's money. \\ \hline
	render & Update the HTML Object with the state of the player's health. \\ \hline
	\end{tabular}
	\end{table}


\subsection*{HudButtons}

	events - Which events this Presenter should receive from the HTML Object.

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	buildPowerPlant & Change the game state to BuildPP. \\ \hline
	buildPowerLine & Change the game state to BuildPL. \\ \hline
	togglePause & Change the game's pause state. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Menu}

	events - Which events this Presenter should receive from the HTML Object.

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	startGame & Start the game. \\ \hline
	instructions & Go to the instruction screen. \\ \hline
	highscore & Go to the highscore screen. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Screen}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Begin listening to changes to the state of the game map. \\ \hline
	resetZoom & Resets the scaling of the HTML canvas. \\ \hline
	render & Draw the map state onto the HTML canvas. \\ \hline
	renderBuildings & Draw buildings to the HTML canvas. \\ \hline
	renderBuildingTemp & Draw a circle below the building selected to build a powerline from. \\ \hline
	renderBuildMode & Draw indicators that the game is in build mode. \\ \hline
	renderPowerLines & Draw the powerlines to the HTML canvas. \\ \hline
  	touchStart & \\ \hline

  	touchEnd & \\ \hline

  	touchMove & \\ \hline

  	doubleTap & \\ \hline

  	handleEvent
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	iOS - Detect if the application is running on iOS.

	needsRepaint - Set to true if the map has to be redrawn.

	prevZoomed - Set to true if the map was "zoomed in" during last render.
	buildingTemp: null,

  	screenMove: false,

  	prevTouchStart: null,

 	prevTouchEnd: null,

  	prevTouchEndTime: -Infinity,

	\end{tabular}
	\end{table}

\subsection*{HeaderTimer}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & \\ \hline
	render & \\ \hline
	\end{tabular}
	\end{table}

\subsection*{HeaderLevel}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & \\ \hline
	render & \\ \hline
	\end{tabular}
	\end{table}

\clearpage

\section{Collections - Backbone Collections}
	
\subsection*{BuildingList}

	model: Entity

\subsection*{HigscoreList}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & \\ \hline
	loadData & \\ \hline
	saveData & \\ \hline
	addScore & \\ \hline
	writeToConsole & \\ \hline

	\end{tabular}
	\end{table}

	
	model: Highscore

	

\subsection*{PowerLineList}

	model: PowerLine

	sample

\clearpage

\section{Singletons}

\subsection*{App}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	gameLevel & null \\ \hline
  	highscoreList & null \\ \hline
  	gameScreen & null \\ \hline
  	timer & null \\ \hline
  	level & null \\ \hline
  	hudBtns & null \\ \hline
  	hudMny & null \\ \hline
  	hpBar & null \\ \hline
  	mainMenu & null \\ \hline
  	highscoreView & null \\ \hline
  	gameRunning & false \\ \hline
	
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & \\ \hline
  	initGame & \\ \hline
  	startGame & \\ \hline
  	stopGame & \\ \hline
  	onDeviceReady & \\ \hline

	\end{tabular}
	\end{table}

	



\subsection*{AudioPlayer}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	mediaSuccess & \\ \hline
	mediaError & \\ \hline
	getMediaStatusString & \\ \hline
	mediaStatus & \\ \hline
	getMediaPath & \\ \hline
	audioPlayer & (init, loadSfx, loadBGM, playBGM, stopBGM, playRandMoney, stopAll) \\ \hline
	\end{tabular}
	\end{table}



\subsection*{ImageLibrary}
	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	imagesLoaded & \\ \hline
	imagesToLoad & \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	imgLib & (isAllImagesLoaded, loadImage) \\ \hline	
	\end{tabular}
	\end{table}

\clearpage

\section{Other}

\subsection*{Utilities}

	\begin{table}[H]
	\begin{tabular}{p{6cm} | p{6cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	requestAnimFrame & \\ \hline
	getPhoneGapPath & \\ \hline
	timeToString & \\ \hline
	onBackButton & \\ \hline
	scrollToTop & \\ \hline
	calcGoal & \\ \hline
	calcLevelSize & \\ \hline
	generateBuildingSpawnTime & \\ \hline
	sqr & \\ \hline
	dist2 & \\ \hline
	distToSegmentSquared & \\ \hline
	distToSegment & \\ \hline

	\end{tabular}
	\end{table}

\clearpage

\subsection*{Constants}

	\begin{table}[H]
	\begin{tabular}{p{6cm} | p{6cm} }

	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	GAME\_FPS & \\ \hline
	DEBUG & \\ \hline
	HUD\_HEIGHT & \\ \hline
	BuildingTemplates & \\ \hline
	BUILDING\_WIDTH & \\ \hline
	BUILDING\_REVENUE\_FREQ & \\ \hline
	BUILDING\_DURABILITY & \\ \hline
	POWERPLANT\_COST & \\ \hline
	POWERPLANT\_MAX\_LEVEL & \\ \hline
	POWERPLANT\_POWER & \\ \hline
	UPGRADE\_COST & \\ \hline
	POWERLINE\_COST & \\ \hline
	POWERLINE\_WIDTH & \\ \hline
	GameState & \\ \hline
	PowerLineState & \\ \hline
	PLAYER\_MAX\_HP & \\ \hline
	PLAYER\_START\_MONEY & \\ \hline

	\end{tabular}
	\end{table}
