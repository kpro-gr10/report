\chapter{Code Documentation}

The code documentation lists the JavaScript objects in bold, followed by a list of their variables and functions.

\clearpage 

\section{Models - Backbone Models}

\subsection*{Building}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	shouldBeRemoved & Returns true if the durability of this building is less than or equal to 0. \\ \hline
	updateRevenue & Makes this building generate revenue. \\ \hline
	lowerDurability & Lower the durability of this building. \\ \hline
	render & Draw this object to a canvas context. \\ \hline
	update & Update the state of this building. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Default values for this object \\ \hline
	timeSinceRevenue & Duration since last time the building generated revenue. \\ \hline

	\end{tabular}
	\end{table}

\subsection*{Entity}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Initialize a PowerLineList for this entity. \\ \hline
	update & Update the state of this entity. Should be overwritten by subclasses. \\ \hline
	getCenterPos & Returns the center position of this entity. \\ \hline
	shouldBeRemoved & Returns if this entity should be removed from the map or not. Should be overwritten by subclasses. \\ \hline
	connectTo & Connect this entity to a PowerLine. \\ \hline
	disconnect & Disconnect this entity from a PowerLine. \\ \hline
	contains & Check if a point is inside of this entity. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Highscore}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	updateTime & Updates this high score object if the new score is smaller than the old score. \\ \hline
	saveData & Write data to local storage. \\ \hline
	toString & Returns a string representation of this object. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{Level}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Initialize and shuffle the list of possible building positions for this level. \\ \hline
	update & Update the state of the level. \\ \hline
	createBuilding & Create a new building and place it on the map. \\ \hline
	tapMap & Process user input. \\ \hline
	buildPowerPlantAt & Build a new Powerplant on the map. \\ \hline
	costOfPowerLine & Calculate the cost of a Powerline. \\ \hline
	costOfFixingPowerLine & Calculate the cost of repairing a Powerline. \\ \hline
	connectWithPowerLine & Connect two buildings with a Powerline. \\ \hline
	fixPowerLine & Repair a Powerline. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Default values for this object. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{Map}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Default values for map. \\ \hline
	\end{tabular}
	\end{table}

	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	update & Update the state of the game map. \\ \hline
	translateView & Move the view of the map. \\ \hline
	getBuildingAt & Returns the building located here on the map. Input coordinates in screen space. \\ \hline
	getBuildingAtMap & Returns the building located here on the map. Input coordinates in world space. \\ \hline
	screenToMapCoordinates & Translate coordinates from screen space to map space. \\ \hline
	getPowerLineAt & Return the powerline located here on the map. Input coordinates in screen space. \\ \hline
	\end{tabular}
	\end{table}

\clearpage

\subsection*{Player}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Varables & Description \\ \hline
	defaults & Player default values. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	damage & Inflict damage to the players health. \\ \hline
	\end{tabular}
	\end{table}
	

\subsection*{Powerline}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	isHealthy & Returns if this Powerline is healthy or not. \\ \hline
	getPointA & Returns the center position of the first building this Powerline is connected to. \\ \hline
	getPointB & Returns the center position of the second building this Powerline is connected to. \\ \hline
	removeFrom & Remove this Powerline from the map and disconnect everything connected to it. \\ \hline
	break & Set the state of this Powerline to broken. \\ \hline
	fix & Set the state of this Powerline to healthy. \\ \hline
	render & Draw this Powerline to the canvas context. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Powerline default values. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Powerplant}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	defaults & Default values for this Powerplant. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	canBeUpgraded & Returns true if this Powerplant can be upgraded. \\ \hline
	getMaxPower & Returns how much power this powerplant can output. \\ \hline
	upgrade & Upgrade this Powerplant. \\ \hline
	distributePower & Distribute power from this Powerplant to as many connected buildings as allowed by getMaxPower using Breadth First Search. \\ \hline
	render & Draw this Powerplant to the canvas context. \\ \hline
	\end{tabular}
	\end{table}
	
\clearpage

\section{Presenters - Backbone Views}

\subsection*{HighscoreView}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Render the highscore list and begin listening to changes to the list. \\ \hline
	render & Update the HTML Object with the state of the highscore list. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{HpBar}
	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the player's health and begin listening to changes to player health. \\ \hline
	render & Draw the player's health to the HP bar canvas. \\ \hline
	\end{tabular}
	\end{table}
	
\subsection*{HudMoney}
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the player's money and begin listening to changes to the player's money. \\ \hline
	render & Update the HTML Object with the state of the player's health. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{HudButtons}

	events - Which events this Presenter should receive from the HTML.

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	buildPowerPlant & Change the game state to BuildPP. \\ \hline
	buildPowerLine & Change the game state to BuildPL. \\ \hline
	togglePause & Change the game's pause state. \\ \hline
	\end{tabular}
	\end{table}

\clearpage
\subsection*{Menu}

	events - Which events this Presenter should receive from the HTML.

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	startGame & Start the game. \\ \hline
	instructions & Go to the instruction screen. \\ \hline
	highscore & Go to the highscore screen. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{Screen}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Begin listening to changes to the state of the game map. \\ \hline
	resetZoom & Resets the scaling of the HTML canvas. \\ \hline
	render & Draw the map state onto the HTML canvas. \\ \hline
	renderBuildings & Draw buildings to the HTML canvas. \\ \hline
	renderBuildingTemp & Draw a circle below the building selected to build a powerline from. \\ \hline
	renderBuildMode & Draw indicators that the game is in build mode. \\ \hline
	renderPowerLines & Draw the powerlines to the HTML canvas. \\ \hline
  	touchStart & \\ \hline
  	touchEnd & \\ \hline
  	touchMove & \\ \hline
  	doubleTap & \\ \hline
  	handleEvent & \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	iOS & Detect if the application is running on iOS. \\ \hline
	needsRepaint & Set to true if the map has to be redrawn. \\ \hline
	buildingTemp & Holds the building that you are currently building a powerline from. \\ \hline
	prevZoomed & Set to true if the map was "zoomed in" during last render. \\ \hline
  	screenMove & Set to true if the current series of touch events has a touch move event. \\ \hline
  	prevTouchStart & Previous touch start event. \\ \hline
 	prevTouchEnd & Previous touch end event. \\ \hline
  	prevTouchEndTime & Time of previous touch end event. \\ \hline
  	touchStart & Called when a touch start event is registered. \\ \hline
  	touchEnd & Called when a touch end event is registered. \\ \hline
  	touchMove & Called when a touch move event is registered. \\ \hline
  	doubleTap & Called when the player double taps the screen. \\ \hline
  	handleEvent & Called when this screen receives an input event. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{HeaderTimer}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the current playtime and begin listening to the level's playtime variable. \\ \hline
	render & Update the HTML with the state of the level's playtime variable. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{HeaderLevel}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Render the current level and begin listening to changes to the level. \\ \hline
	render & Update the HTML with the level.  \\ \hline
	\end{tabular}
	\end{table}

\clearpage

\section{Collections - Backbone Collections}
	
\subsection*{BuildingList}

	model: Entity

\subsection*{HigscoreList}

	model: Highscore

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Load highscore data. \\ \hline
	loadData & Read highscore data from local storage. \\ \hline
	saveData & Save highscore data to local storage. \\ \hline
	addScore & If the new score is better than the old, update the level's highscore. \\ \hline
	writeToConsole & Write the highscore list to console for debug purposes. \\ \hline

	\end{tabular}
	\end{table}	

\subsection*{PowerLineList}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	sample & Return a random object from this list. \\ \hline
	\end{tabular}
	\end{table}

	model: PowerLine

\clearpage

\section{Singletons}

\subsection*{App}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Variables & Description \\ \hline
	gameLevel & Current level model. \\ \hline
  	highscoreList & List of highscores. \\ \hline
  	gameScreen & Screen presenter. \\ \hline
  	timer & Timer presenter. \\ \hline
  	level & Level presenter. \\ \hline
  	hudBtns & Hud Buttons presenter. \\ \hline
  	hudMny & Hud Player Money presenter. \\ \hline
  	hpBar & Player Health presenter. \\ \hline
  	mainMenu & Main menu presenter. \\ \hline
  	highscoreView & Highscore presenter. \\ \hline
  	gameRunning & True if the game loop is running. \\ \hline
	
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	initialize & Initialize this object's data. \\ \hline
  	initGame & Init a new game. \\ \hline
  	startGame & Start the game. \\ \hline
  	stopGame & Stop the game. \\ \hline
  	onDeviceReady & The device is ready and we can start the game. \\ \hline

	\end{tabular}
	\end{table}

	



\subsection*{AudioPlayer}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Global Functions & Description \\ \hline
	mediaSuccess & Function for printing audio debug information. \\ \hline
	mediaError & Function for printing audio debug information. \\ \hline
	getMediaStatusString & Function for printing audio debug information. \\ \hline
	mediaStatus & Function for printing audio debug information. \\ \hline
	getMediaPath & Get the path to the sound file.  \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	init & Initialize the audio player's sound files. \\ \hline
	loadSfx & Load a audio file. \\ \hline
	playRandMoney & Play a random money sound effect. \\ \hline
	\end{tabular}
	\end{table}

\subsection*{ImageLibrary}
	
	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Global Variables & Description \\ \hline
	imagesLoaded & Number of images loaded. \\ \hline
	imagesToLoad & Number of images that has to be loaded. \\ \hline
	\end{tabular}
	\end{table}

	\begin{table}[H]
	\begin{tabular}{p{4cm} | p{8cm} }
	\hline
	\rowcolor{gray}
	Functions & Description \\ \hline
	isAllImagesLoaded & Returns true if all images attempted to be loaded with the loadImage function is done loading. \\ \hline	
	loadImage & Load and return an image object. \\ \hline	
	\end{tabular}
	\end{table}

\clearpage

\section{Other}

\subsection*{Utilities}

	\begin{table}[H]
	\begin{tabular}{p{6cm} | p{6cm} }
	\hline
	\rowcolor{gray}
	Global Functions & Description \\ \hline
	requestAnimFrame & \url{www.paulirish.com/2011/requestanimationframe-for-smart-animating/} \\ \hline
	getPhoneGapPath & Returns the path to phonegap, device independently. \\ \hline
	timeToString & Translate a time in seconds to a string. \\ \hline
	onBackButton & Called when the backbutton on the device is pressed. \\ \hline
	scrollToTop & Scroll to the top of the html page. \\ \hline
	calcGoal & Calculate a goal for the level. \\ \hline
	calcLevelSize & Calculat ethe size of the map. \\ \hline
	generateBuildingSpawnTime & Calculate time to the next building spawn. \\ \hline
	sqr & Returns the square of the input number. \\ \hline
	dist2 & Returns the square of the distance between two points. \\ \hline
	distToSegmentSquared & Returns the square of the distance from a point to a line segment. \\ \hline
	distToSegment &  Returns the distance to from a point to a line segment. \\ \hline

	\end{tabular}
	\end{table}

\clearpage

\subsection*{Constants}

	\begin{table}[H]
	\begin{tabular}{p{6cm} | p{6cm} }

	\hline
	\rowcolor{gray}
	Global Variables & Description \\ \hline
	GAME\_FPS & Game frame rate. \\ \hline
	DEBUG & Print debug to console. \\ \hline
	HUD\_HEIGHT & Height of the UI hud. \\ \hline
	BuildingTemplates & Buildings to place on the map. \\ \hline
	BUILDING\_WIDTH & Buidling dimensions. \\ \hline
	BUILDING\_REVENUE\_FREQ & How often buildings generate money \\ \hline
	BUILDING\_DURABILITY & How long in ms before a building without power becomes abandoned. \\ \hline
	POWERPLANT\_COST & Cost of building a powerplant. \\ \hline
	POWERPLANT\_MAX\_LEVEL & Max level for powerplants. \\ \hline
	POWERPLANT\_POWER & Array of powers generated by a powerplant, by level. \\ \hline
	UPGRADE\_COST & Cost of upgrading a powerplant. \\ \hline
	POWERLINE\_COST & Cost per pixel for building a powerline. \\ \hline
	POWERLINE\_WIDTH & Width of a powerline for rendering and registering user clicking on powerlines. \\ \hline
	GameState & Collection of possible game states. \\ \hline
	PowerLineState & Collection of possible states for a powerline. \\ \hline
	PLAYER\_MAX\_HP & Player health at the beginning of each level. \\ \hline
	PLAYER\_START\_MONEY & Player money at the beginning of each level. \\ \hline

	\end{tabular}
	\end{table}
